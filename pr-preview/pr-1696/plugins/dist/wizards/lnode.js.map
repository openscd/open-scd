{"version":3,"file":"lnode.js","sourceRoot":"","sources":["../../src/wizards/lnode.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,IAAI,EAAE,MAAM,EAAkB,MAAM,UAAU,CAAC;AACxD,OAAO,EAAE,GAAG,EAAE,MAAM,eAAe,CAAC;AAEpC,OAAO,oBAAoB,CAAC;AAC5B,OAAO,wCAAwC,CAAC;AAChD,OAAO,kCAAkC,CAAC;AAE1C,OAAO,EAAE,QAAQ,EAAE,MAAM,kCAAkC,CAAC;AAI5D,OAAO,wCAAwC,CAAC;AAChD,OAAO,EACL,IAAI,EACJ,QAAQ,EACR,QAAQ,EACR,QAAQ,EACR,cAAc,EACd,aAAa,EAKb,kBAAkB,GACnB,MAAM,qCAAqC,CAAC;AAE7C,OAAO,EACL,YAAY,EACZ,aAAa,EACb,yBAAyB,GAC1B,MAAM,cAAc,CAAC;AAEtB,OAAO,EAAE,QAAQ,EAAE,MAAM,wBAAwB,CAAC;AAKlD,OAAO,EAAE,WAAW,EAAE,MAAM,gDAAgD,CAAC;AAE7E,SAAS,iBAAiB,CAAC,MAAe;IACxC,OAAO,CACL,MAA4B,EAC5B,MAAe,EACf,IAAkB,EACF,EAAE;QAClB,MAAM,kBAAkB,GAAc,IAAK,CAAC,KAAK;aAC9C,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC;aAC7B,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,KAAK,CAAC;aACvB,GAAG,CAAC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE,WAAW,EAAE,QAAQ,CAAC,CAAC;aAClE,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,KAAK,IAAI,CAAC,CAAC;QAEjC,MAAM,eAAe,GAAG,kBAAkB,CAAC,MAAM,CAAC,CAAC;QAEnD,MAAM,aAAa,GAAuB,kBAAkB;aACzD,GAAG,CAAC,iBAAiB,CAAC,EAAE;YACvB,MAAM,OAAO,GAAG,iBAAiB,CAAC,YAAY,CAAC,SAAS,CAAC,CAAC;YAC1D,IAAI,CAAC,OAAO;gBAAE,OAAO,IAAI,CAAC;YAE1B,MAAM,YAAY,GAAG,eAAe,CAAC,OAAO,CAAC,CAAC;YAE9C,IAAI,CAAC,YAAY,EAAE;gBACjB,MAAM,CAAC,aAAa,CAClB,WAAW,CAAC;oBACV,IAAI,EAAE,OAAO;oBACb,KAAK,EAAE,GAAG,CAAC,iBAAiB,EAAE,EAAE,OAAO,EAAE,CAAC;oBAC1C,OAAO,EAAE,GAAG,CAAC,2BAA2B,CAAC;iBAC1C,CAAC,CACH,CAAC;gBACF,OAAO;aACR;YAED,MAAM,OAAO,GAAG,yBAAyB,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC,IAAI,CAC7D,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,YAAY,CAAC,SAAS,CAAC,KAAK,MAAM,CAClD,CAAC;YACF,IAAI,OAAO,KAAK,MAAM,IAAI,OAAO,EAAE;gBACjC,MAAM,CAAC,aAAa,CAClB,WAAW,CAAC;oBACV,IAAI,EAAE,OAAO;oBACb,KAAK,EAAE,GAAG,CAAC,iBAAiB,EAAE,EAAE,OAAO,EAAE,CAAC;oBAC1C,OAAO,EAAE,GAAG,CAAC,qBAAqB,EAAE,EAAE,OAAO,EAAE,CAAC;iBACjD,CAAC,CACH,CAAC;gBACF,OAAO;aACR;YAED,MAAM,OAAO,GAAG,yBAAyB,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC,IAAI,CAC7D,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,YAAY,CAAC,SAAS,CAAC,KAAK,MAAM,CAClD,CAAC;YACF,IAAI,OAAO,KAAK,MAAM,IAAI,OAAO,EAAE;gBACjC,MAAM,CAAC,aAAa,CAClB,WAAW,CAAC;oBACV,IAAI,EAAE,OAAO;oBACb,KAAK,EAAE,GAAG,CAAC,iBAAiB,EAAE,EAAE,OAAO,EAAE,CAAC;oBAC1C,OAAO,EAAE,GAAG,CAAC,qBAAqB,EAAE,EAAE,OAAO,EAAE,CAAC;iBACjD,CAAC,CACH,CAAC;gBACF,OAAO;aACR;YAED,MAAM,MAAM,GAAG,OAAO,KAAK,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,YAAY,CAAC;YAEtD,MAAM,OAAO,GAAG,aAAa,CAAC,MAAM,CAAC,aAAa,EAAE,OAAO,EAAE;gBAC3D,OAAO,EAAE,MAAM;gBACf,MAAM,EAAE,IAAI;gBACZ,MAAM,EAAE,IAAI;gBACZ,OAAO;gBACP,MAAM;gBACN,MAAM,EAAE,iBAAiB,CAAC,YAAY,CAAC,IAAI,CAAE;aAC9C,CAAC,CAAC;YAEH,OAAO,EAAE,GAAG,EAAE,EAAE,MAAM,EAAE,OAAO,EAAE,EAAE,CAAC;QACtC,CAAC,CAAC;aACD,MAAM,CAAC,MAAM,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC;QAE5B,OAAO,aAAa,CAAC;IACvB,CAAC,CAAC;AACJ,CAAC;AAED,SAAS,wBAAwB,CAAC,MAAe;IAC/C,OAAO,CAAC,MAAe,EAAQ,EAAE;QAC/B,MAAM,CAAC,aAAa,CAAC,cAAc,EAAE,CAAC,CAAC;QACvC,MAAM,CAAC,aAAa,CAAC,cAAc,CAAC,oBAAoB,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;IACrE,CAAC,CAAC;AACJ,CAAC;AAED,SAAS,mBAAmB,CAAC,MAAe;IAC1C,MAAM,UAAU,GAAG,KAAK,CAAC,IAAI,CAC3B,MAAM,CAAC,aAAa,CAAC,gBAAgB,CAAC,WAAW,CAAC,CACnD,CAAC;IAEF,OAAO;QACL;YACE,KAAK,EAAE,GAAG,CAAC,qCAAqC,CAAC;YACjD,WAAW,EAAE;gBACX;oBACE,IAAI,EAAE,EAAE;oBACR,KAAK,EAAE,GAAG,CAAC,wBAAwB,CAAC;oBACpC,MAAM,EAAE,wBAAwB,CAAC,MAAM,CAAC;iBACzC;aACF;YACD,OAAO,EAAE;gBACP,IAAI,EAAE,MAAM;gBACZ,KAAK,EAAE,GAAG,CAAC,MAAM,CAAC;gBAClB,MAAM,EAAE,iBAAiB,CAAC,MAAM,CAAC;aAClC;YACD,OAAO,EAAE;gBACP,IAAI,CAAA;aACC,UAAU,CAAC,GAAG,CAAC,SAAS,CAAC,EAAE;oBAC5B,MAAM,UAAU,GACd,CAAC,SAAS,CAAC,YAAY,CAAC,SAAS,CAAC,KAAK,MAAM;wBAC3C,yBAAyB,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC,IAAI,CAC7C,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,YAAY,CAAC,SAAS,CAAC,KAAK,MAAM,CAClD,CAAC;wBACJ,CAAC,SAAS,CAAC,YAAY,CAAC,SAAS,CAAC,KAAK,MAAM;4BAC3C,yBAAyB,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC,IAAI,CAC7C,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,YAAY,CAAC,SAAS,CAAC,KAAK,MAAM,CAClD,CAAC,CAAC;oBAEP,OAAO,IAAI,CAAA;;uBAEA,QAAQ,CAAC,SAAS,CAAC;0BAChB,UAAU;uBACb,SAAS,CAAC,YAAY,CAAC,SAAS,CAAC;;mBAErC,UAAU;wBACX,CAAC,CAAC,GAAG,CAAC,4BAA4B,CAAC;wBACnC,CAAC,CAAC,QAAQ,CAAC,SAAS,CAAC;;cAEzB,CAAC;gBACL,CAAC,CAAC;UACF;aACH;SACF;KACF,CAAC;AACJ,CAAC;AAUD,wEAAwE;AACxE,MAAM,WAAW,GAAsC;IACrD,GAAG,EAAE,CAAC,MAAM,EAAE,MAAM,EAAE,MAAM,CAAC;IAC7B,GAAG,EAAE,CAAC,MAAM,EAAE,MAAM,EAAE,MAAM,CAAC;IAC7B,GAAG,EAAE,CAAC,MAAM,CAAC;IACb,GAAG,EAAE,CAAC,MAAM,CAAC;IACb,GAAG,EAAE,CAAC,MAAM,CAAC;IACb,YAAY,EAAE,CAAC,MAAM,CAAC;IACtB,UAAU,EAAE,CAAC,MAAM,CAAC;CACrB,CAAC;AAEF,6EAA6E;AAC7E,SAAS,OAAO,CAAC,CAAkB,EAAE,CAAkB;IACrD,IAAI,CAAC,CAAC,QAAQ,KAAK,CAAC,CAAC,QAAQ;QAAE,OAAO,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAE1D,IAAI,CAAC,CAAC,SAAS,KAAK,CAAC,CAAC,SAAS;QAAE,OAAO,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAE7D,IAAI,CAAC,CAAC,QAAQ,KAAK,CAAC,CAAC,QAAQ;QAAE,OAAO,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAE1D,OAAO,CAAC,CAAC;AACX,CAAC;AAED,MAAM,QAAQ,GAAG,WAAW,CAAC;AAE7B,yEAAyE;AACzE,MAAM,UAAU,QAAQ,CACtB,MAA6B,EAC7B,KAAc;IAEd,OAAO,CACL,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,oBAAoB,CAAC,OAAO,CAAC,CAAC;SAC7C,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;SACxC,MAAM,CAAC,KAAK,CAAC,EAAE,CAAC,gBAAgB,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,IAAI,CAC9D,CAAC;AACJ,CAAC;AAED,SAAS,gBAAgB,CAAC,KAAc,EAAE,KAAc;IACtD,OAAO,CACL,CAAC,KAAK,CAAC,YAAY,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC;QACnC,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE,YAAY,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC;QACpD,CAAC,KAAK,CAAC,YAAY,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;YAClC,CAAC,KAAK,CAAC,OAAO,CAAC,SAAS,CAAC,EAAE,YAAY,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC;QACxD,CAAC,KAAK,CAAC,YAAY,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;YAClC,CAAC,KAAK,CAAC,YAAY,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;QACtC,CAAC,KAAK,CAAC,YAAY,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC;YACnC,CAAC,KAAK,CAAC,YAAY,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC;QACvC,CAAC,KAAK,CAAC,YAAY,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC,KAAK,CAAC,YAAY,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC,CAC5E,CAAC;AACJ,CAAC;AAED,SAAS,YAAY,CAAC,MAAe,EAAE,KAAc;IACnD,MAAM,OAAO,GAAG,aAAa,CAAC,MAAM,CAAC,aAAa,EAAE,OAAO,EAAE;QAC3D,OAAO,EAAE,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE,YAAY,CAAC,MAAM,CAAC,IAAI,EAAE;QACzD,MAAM,EAAE,KAAK,CAAC,OAAO,CAAC,SAAS,CAAC,EAAE,YAAY,CAAC,MAAM,CAAC,IAAI,EAAE;QAC5D,MAAM,EAAE,KAAK,CAAC,YAAY,CAAC,QAAQ,CAAC,IAAI,EAAE;QAC1C,OAAO,EAAE,KAAK,CAAC,YAAY,CAAC,SAAS,CAAC,IAAI,EAAE;QAC5C,MAAM,EAAE,KAAK,CAAC,YAAY,CAAC,MAAM,CAAC,IAAI,EAAE;KACzC,CAAC,CAAC;IAEH,OAAO;QACL,GAAG,EAAE;YACH,MAAM;YACN,OAAO;SACR;KACF,CAAC;AACJ,CAAC;AAED,SAAS,YAAY,CAAC,MAAe,EAAE,KAAc;IACnD,OAAO;QACL,GAAG,EAAE;YACH,MAAM,EAAE,MAAM;YACd,OAAO,EAAE,KAAK;YACd,SAAS,EAAE,KAAK,CAAC,kBAAkB;SACpC;KACF,CAAC;AACJ,CAAC;AAED,SAAS,aAAa,CAAC,MAAiB,EAAE,KAAc;IACtD,OAAO,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,gBAAgB,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC,CAAC;AAC9D,CAAC;AAED,SAAS,aAAa,CAAC,KAAc,EAAE,MAAiB;IACtD,OAAO,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,gBAAgB,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC,CAAC;AAC9D,CAAC;AAED;;;GAGG;AACH,MAAM,UAAU,iBAAiB,CAAC,MAAe;IAC/C,OAAO,CACL,MAA4B,EAC5B,MAAe,EACf,IAAkB,EACF,EAAE;QAClB,MAAM,aAAa,GAAc,IAAK,CAAC,KAAK;aACzC,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC;aAC7B,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,KAAK,CAAC;aACvB,GAAG,CAAC,QAAQ,CAAC,EAAE;YACd,MAAM,GAAG,GAAG,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE,KAAK,EAAE,QAAQ,CAAC,CAAC;YACxD,IAAI,GAAG;gBAAE,OAAO,GAAG,CAAC;YACpB,OAAO,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE,IAAI,EAAE,QAAQ,CAAC,CAAC;QACpD,CAAC,CAAC;aACD,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,KAAK,IAAI,CAAC,CAAC;QAEjC,MAAM,SAAS,GAAG,yBAAyB,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC,MAAM,CACjE,QAAQ,CACT,CAAC;QAEF,MAAM,aAAa,GAAG,SAAS;aAC5B,MAAM,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,aAAa,CAAC,aAAa,EAAE,KAAK,CAAC,CAAC;aACrD,GAAG,CAAC,KAAK,CAAC,EAAE,CAAC,YAAY,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC,CAAC;QAC7C,MAAM,aAAa,GAAG,aAAa;aAChC,MAAM,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,aAAa,CAAC,KAAK,EAAE,SAAS,CAAC,CAAC;aACjD,GAAG,CAAC,KAAK,CAAC,EAAE,CAAC,YAAY,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC,CAAC;QAE7C,OAAO,aAAa,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC;IAC7C,CAAC,CAAC;AACJ,CAAC;AAED,SAAS,gBAAgB,CAAC,MAAe,EAAE,QAAgB;IACzD,OAAO,CACL,MAAM,CAAC,aAAa,EAAE,aAAa,EAAE,kBAAkB,EAAE,aAAa,CACpE,QAAQ,CACT,IAAI,IAAI,CACV,CAAC;AACJ,CAAC;AAED,SAAS,WAAW,CAAC,GAAuB,EAAE,MAAe;IAC3D,IAAI,CAAC,CAAC,GAAG,CAAC,MAAM,YAAY,QAAQ,CAAC;QAAE,OAAO;IAC9C,MAAM,MAAM,GAAG,gBAAgB,CAAC,GAAG,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;IACvD,IAAI,MAAM,KAAK,IAAI;QAAE,OAAO;IAE5B,MAAM,GAAG,GAAG,MAAM,CAAC,aAAa,CAAC;IAEjC,MAAM,gBAAgB,GAAe,GAAG,CAAC,MAAM,CAAC,QAAQ,CAAC;IAEzD,MAAM,OAAO,GAAG,gBAAgB;SAC7B,OAAO,CAAC,IAAI,CAAC,EAAE,CACd,KAAK,CAAC,IAAI,CACR,GAAG,CAAC,gBAAgB,CAClB,qBAAqB,IAAI,CAAC,KAAK,wBAAwB;QACrD,qBAAqB,IAAI,CAAC,KAAK,2CAA2C;QAC1E,qBAAqB,IAAI,CAAC,KAAK,2CAA2C,CAC7E,CACF,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,CAC3C;SACA,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,KAAK,IAAI,CAAC;SAC7B,GAAG,CAAC,IAAI,CAAC,EAAE;QACV,MAAM,UAAU,GACd,WAAW,CACT,MAAM,CAAC,YAAY,CAAC,MAAM,CAAC;YACzB,CAAC,CAAC,MAAM,CAAC,YAAY,CAAC,MAAM,CAAC,IAAI,EAAE;YACnC,CAAC,CAAC,MAAM,CAAC,OAAO,IAAI,EAAE,CACzB,EAAE,QAAQ,CAAC,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC,IAAI,KAAK,CAAC;QAE3D,MAAM,KAAK,GAAG,QAAQ,CAAC,MAAM,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC;QACnD,MAAM,QAAQ,GAAG,KAAK,EAAE,aAAa,KAAK,MAAM,CAAC;QAEjD,OAAO;YACL,QAAQ;YACR,QAAQ,EAAE,KAAK,KAAK,IAAI,IAAI,CAAC,QAAQ;YACrC,QAAQ,EAAE,UAAU;YACpB,OAAO,EAAE,IAAI;SACd,CAAC;IACJ,CAAC,CAAC;SACD,IAAI,CAAC,OAAO,CAAC,CAAC;IAEjB,MAAM,WAAW,GAAG,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;QACrC,OAAO,IAAI,CAAA;kBACG,IAAI,CAAC,QAAQ;kBACb,IAAI,CAAC,QAAQ;eAChB,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC;;;WAG1B,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,QAAQ,CAAC;YACtC,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,SAAS,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,YAAY,CACnE,MAAM,CACP,IAAI,EAAE;UACL,IAAI,CAAC,QAAQ;YACb,CAAC,CAAC,IAAI,CAAA;;;gBAGA,aAAa,CAAC,QAAQ,CAAC,GAAG,EAAE,IAAI,CAAC,OAAO,CAAE,CAAC,EAAE;YACnD,CAAC,CAAC,EAAE;;WAEH,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE,YAAY,CAAC,MAAM,CAAC,IAAI,EAAE;UACxD,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,SAAS,CAAC;YAC/B,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,SAAS,CAAC,EAAE,YAAY,CAAC,MAAM,CAAC;YACvD,CAAC,CAAC,QAAQ;;MAEd,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,MAAM,CAAC,IAAI,CAAA,GAAG,WAAW,EAAE,EAAE,MAAM,CAAC,CAAC;AACvC,CAAC;AAED,SAAS,aAAa,CAAC,OAAgB;IACrC,MAAM,GAAG,GAAG,OAAO,CAAC,aAAa,CAAC;IAClC,IAAI,GAAG,CAAC,gBAAgB,CAAC,aAAa,CAAC,CAAC,MAAM,GAAG,CAAC;QAChD,OAAO,IAAI,CAAA;;;;kBAIG,CAAC,GAAuB,EAAE,EAAE,CAAC,WAAW,CAAC,GAAG,EAAE,OAAO,CAAC;SAC/D,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,gBAAgB,CAAC,aAAa,CAAC,CAAC;aAC/C,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,YAAY,CAAC,MAAM,CAAE,CAAC;aACrC,GAAG,CAAC,OAAO,CAAC,EAAE;YACb,OAAO;gBACL,QAAQ,EACN,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC;qBACzB,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;qBACxC,MAAM,CACL,IAAI,CAAC,EAAE,CACL,IAAI,CAAC,OAAO,KAAK,OAAO;oBACxB,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,KAAK,OAAO,CAC3C,CAAC,MAAM,GAAG,CAAC;gBAChB,OAAO,EAAE,OAAO;aACjB,CAAC;QACJ,CAAC,CAAC;aACD,IAAI,CAAC,OAAO,CAAC;aACb,GAAG,CACF,IAAI,CAAC,EAAE,CACL,IAAI,CAAA;uBACO,IAAI,CAAC,OAAO,IAAI,EAAE;0BACf,IAAI,CAAC,QAAQ;iBACtB,IAAI,CAAC,OAAO;cACf,CACL;MACH,CAAC;;QAEH,OAAO,IAAI,CAAA;cACD,GAAG,CAAC,0BAA0B,CAAC;;qBAExB,CAAC;AACtB,CAAC;AAED,SAAS,uBAAuB,CAAC,MAAe;IAC9C,OAAO,CAAC,MAAe,EAAQ,EAAE;QAC/B,MAAM,CAAC,aAAa,CAAC,cAAc,EAAE,CAAC,CAAC;QACvC,MAAM,CAAC,aAAa,CAAC,cAAc,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;IACpE,CAAC,CAAC;AACJ,CAAC;AAED,SAAS,oBAAoB,CAAC,MAAe;IAC3C,OAAO;QACL;YACE,KAAK,EAAE,GAAG,CAAC,+BAA+B,CAAC;YAC3C,WAAW,EAAE;gBACX;oBACE,IAAI,EAAE,EAAE;oBACR,KAAK,EAAE,GAAG,CAAC,uBAAuB,CAAC;oBACnC,MAAM,EAAE,uBAAuB,CAAC,MAAM,CAAC;iBACxC;aACF;YACD,OAAO,EAAE,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;SACjC;QACD;YACE,OAAO,EAAE,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,IAAI,CACvC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,OAAO,KAAK,OAAO,CACnC;YACD,KAAK,EAAE,GAAG,CAAC,8BAA8B,CAAC;YAC1C,OAAO,EAAE;gBACP,IAAI,EAAE,MAAM;gBACZ,KAAK,EAAE,GAAG,CAAC,MAAM,CAAC;gBAClB,MAAM,EAAE,iBAAiB,CAAC,MAAM,CAAC;aAClC;YACD,OAAO,EAAE,CAAC,IAAI,CAAA,mDAAmD,CAAC;SACnE;KACF,CAAC;AACJ,CAAC;AAED,kEAAkE;AAClE,MAAM,UAAU,WAAW,CAAC,MAAe;IACzC,IACE,MAAM,CAAC,OAAO,KAAK,UAAU;QAC7B,MAAM,CAAC,OAAO,KAAK,aAAa;QAChC,MAAM,CAAC,OAAO,KAAK,YAAY;QAC/B,MAAM,CAAC,OAAO,KAAK,eAAe;QAElC,OAAO,mBAAmB,CAAC,MAAM,CAAC,CAAC;IAErC,OAAO,oBAAoB,CAAC,MAAM,CAAC,CAAC;AACtC,CAAC;AAWD,SAAS,kBAAkB,CAAC,OAAuB;IACjD,MAAM,QAAQ,GAAG,OAAO,CAAC,OAAO,KAAK,MAAM,CAAC;IAE5C,OAAO;QACL,IAAI,CAAA;;oBAEY,OAAO,CAAC,OAAO;gBACnB,GAAG,CAAC,aAAa,CAAC;;;yBAGT;QACrB,IAAI,CAAA;;oBAEY,OAAO,CAAC,MAAM;gBAClB,GAAG,CAAC,YAAY,CAAC;;;;yBAIR;QACrB,IAAI,CAAA;;oBAEY,OAAO,CAAC,MAAM;gBAClB,GAAG,CAAC,YAAY,CAAC;iBAChB,QAAQ,CAAC,QAAQ;;;;kBAIhB,QAAQ;yBACD;QACrB,IAAI,CAAA;;oBAEY,OAAO,CAAC,OAAO;gBACnB,GAAG,CAAC,aAAa,CAAC;;;yBAGT;QACrB,IAAI,CAAA;;oBAEY,OAAO,CAAC,MAAM;gBAClB,GAAG,CAAC,YAAY,CAAC;;;;;wBAKT,OAAO,CAAC,cAAc;kBAC5B,QAAQ;yBACD;KACtB,CAAC;AACJ,CAAC;AAED,SAAS,iBAAiB,CAAC,OAAgB;IACzC,OAAO,CAAC,MAA4B,EAAkB,EAAE;QACtD,MAAM,UAAU,GAAkC,EAAE,CAAC;QACrD,MAAM,aAAa,GAAG,CAAC,SAAS,EAAE,QAAQ,EAAE,QAAQ,EAAE,SAAS,EAAE,QAAQ,CAAC,CAAC;QAE3E,aAAa,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE;YAC1B,UAAU,CAAC,GAAG,CAAC,GAAG,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,KAAK,KAAK,GAAG,CAAE,CAAC,CAAC;QACjE,CAAC,CAAC,CAAC;QAEH,IAAI,WAAW,GAAwB,IAAI,CAAC;QAC5C,IACE,aAAa,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,UAAU,CAAC,GAAG,CAAC,KAAK,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC,EACxE;YACA,MAAM,UAAU,GAAG,YAAY,CAAC,OAAO,EAAE,UAAU,CAAC,CAAC;YACrD,WAAW,GAAG;gBACZ,GAAG,EAAE,EAAE,OAAO,EAAE;gBAChB,GAAG,EAAE,EAAE,OAAO,EAAE,UAAU,EAAE;aAC7B,CAAC;YACF,OAAO,CAAC,WAAW,CAAC,CAAC;SACtB;QAED,OAAO,EAAE,CAAC;IACZ,CAAC,CAAC;AACJ,CAAC;AAED,MAAM,UAAU,eAAe,CAAC,OAAgB;IAC9C,MAAM,CAAC,OAAO,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,MAAM,CAAC,GAAG;QACjD,SAAS;QACT,QAAQ;QACR,QAAQ;QACR,SAAS;QACT,QAAQ;KACT,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,OAAO,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC,CAAC;IAE1C,MAAM,cAAc,GAAG,yBAAyB,CAC9C,OAAO,CAAC,aAAa,EACrB,OAAO,CACR;SACE,MAAM,CACL,OAAO,CAAC,EAAE,CACR,OAAO,KAAK,OAAO;QACnB,OAAO,CAAC,YAAY,CAAC,SAAS,CAAC,KAAK,OAAO,CAAC,YAAY,CAAC,SAAS,CAAC,CACtE;SACA,GAAG,CAAC,OAAO,CAAC,EAAE,CAAC,OAAO,CAAC,YAAY,CAAC,QAAQ,CAAE,CAAC,CAAC;IAEnD,OAAO;QACL;YACE,KAAK,EAAE,GAAG,CAAC,mBAAmB,EAAE,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC;YACrD,OAAO;YACP,OAAO,EAAE;gBACP,KAAK,EAAE,GAAG,CAAC,MAAM,CAAC;gBAClB,IAAI,EAAE,MAAM;gBACZ,MAAM,EAAE,iBAAiB,CAAC,OAAO,CAAC;aACnC;YACD,OAAO,EAAE;gBACP,GAAG,kBAAkB,CAAC;oBACpB,OAAO;oBACP,MAAM;oBACN,MAAM;oBACN,OAAO;oBACP,MAAM;oBACN,cAAc;iBACf,CAAC;aACH;SACF;KACF,CAAC;AACJ,CAAC","sourcesContent":["import { html, render, TemplateResult } from 'lit-html';\nimport { get } from 'lit-translate';\n\nimport '@material/mwc-icon';\nimport '@material/mwc-list/mwc-check-list-item';\nimport '@material/mwc-list/mwc-list-item';\nimport { List } from '@material/mwc-list';\nimport { ListBase } from '@material/mwc-list/mwc-list-base';\nimport { ListItem } from '@material/mwc-list/mwc-list-item';\nimport { MultiSelectedEvent } from '@material/mwc-list/mwc-list-foundation';\n\nimport '@openscd/open-scd/src/filtered-list.js';\nimport {\n  find,\n  getValue,\n  identity,\n  isPublic,\n  newWizardEvent,\n  referencePath,\n  Wizard,\n  WizardActor,\n  WizardInputElement,\n  WizardMenuActor,\n  newLnInstGenerator,\n} from '@openscd/open-scd/src/foundation.js';\n\nimport {\n  cloneElement,\n  createElement,\n  getChildElementsByTagName,\n} from '@openscd/xml';\n\nimport { patterns } from './foundation/limits.js';\nimport {\n  Create,\n  EditorAction,\n} from '@openscd/core/foundation/deprecated/editor.js';\nimport { newLogEvent } from '@openscd/core/foundation/deprecated/history.js';\n\nfunction createLNodeAction(parent: Element): WizardActor {\n  return (\n    inputs: WizardInputElement[],\n    wizard: Element,\n    list?: List | null\n  ): EditorAction[] => {\n    const selectedLNodeTypes = <Element[]>list!.items\n      .filter(item => item.selected)\n      .map(item => item.value)\n      .map(identity => find(parent.ownerDocument, 'LNodeType', identity))\n      .filter(item => item !== null);\n\n    const lnInstGenerator = newLnInstGenerator(parent);\n\n    const createActions: Create[] = <Create[]>selectedLNodeTypes\n      .map(selectedLNodeType => {\n        const lnClass = selectedLNodeType.getAttribute('lnClass');\n        if (!lnClass) return null;\n\n        const uniqueLnInst = lnInstGenerator(lnClass);\n\n        if (!uniqueLnInst) {\n          wizard.dispatchEvent(\n            newLogEvent({\n              kind: 'error',\n              title: get('lnode.log.title', { lnClass }),\n              message: get('lnode.log.nonuniquelninst'),\n            })\n          );\n          return;\n        }\n\n        const hasLLN0 = getChildElementsByTagName(parent, 'LNode').some(\n          lnode => lnode.getAttribute('lnClass') === 'LLN0'\n        );\n        if (lnClass === 'LLN0' && hasLLN0) {\n          wizard.dispatchEvent(\n            newLogEvent({\n              kind: 'error',\n              title: get('lnode.log.title', { lnClass }),\n              message: get('lnode.log.uniqueln0', { lnClass }),\n            })\n          );\n          return;\n        }\n\n        const hasLPHD = getChildElementsByTagName(parent, 'LNode').some(\n          lnode => lnode.getAttribute('lnClass') === 'LPHD'\n        );\n        if (lnClass === 'LPHD' && hasLPHD) {\n          wizard.dispatchEvent(\n            newLogEvent({\n              kind: 'error',\n              title: get('lnode.log.title', { lnClass }),\n              message: get('lnode.log.uniqueln0', { lnClass }),\n            })\n          );\n          return;\n        }\n\n        const lnInst = lnClass === 'LLN0' ? '' : uniqueLnInst;\n\n        const element = createElement(parent.ownerDocument, 'LNode', {\n          iedName: 'None',\n          ldInst: null,\n          prefix: null,\n          lnClass,\n          lnInst,\n          lnType: selectedLNodeType.getAttribute('id')!,\n        });\n\n        return { new: { parent, element } };\n      })\n      .filter(action => action);\n\n    return createActions;\n  };\n}\n\nfunction openLNodeReferenceWizard(parent: Element): WizardMenuActor {\n  return (wizard: Element): void => {\n    wizard.dispatchEvent(newWizardEvent());\n    wizard.dispatchEvent(newWizardEvent(lNodeReferenceWizard(parent)));\n  };\n}\n\nfunction lNodeInstanceWizard(parent: Element): Wizard {\n  const lNodeTypes = Array.from(\n    parent.ownerDocument.querySelectorAll('LNodeType')\n  );\n\n  return [\n    {\n      title: get('lnode.wizard.title.selectLNodeTypes'),\n      menuActions: [\n        {\n          icon: '',\n          label: get('lnode.wizard.reference'),\n          action: openLNodeReferenceWizard(parent),\n        },\n      ],\n      primary: {\n        icon: 'save',\n        label: get('save'),\n        action: createLNodeAction(parent),\n      },\n      content: [\n        html`<filtered-list multi\n          >${lNodeTypes.map(lNodeType => {\n            const isDisabled =\n              (lNodeType.getAttribute('lnClass') === 'LLN0' &&\n                getChildElementsByTagName(parent, 'LNode').some(\n                  lnode => lnode.getAttribute('lnClass') === 'LLN0'\n                )) ||\n              (lNodeType.getAttribute('lnClass') === 'LPHD' &&\n                getChildElementsByTagName(parent, 'LNode').some(\n                  lnode => lnode.getAttribute('lnClass') === 'LPHD'\n                ));\n\n            return html`<mwc-check-list-item\n              twoline\n              value=\"${identity(lNodeType)}\"\n              ?disabled=${isDisabled}\n              ><span>${lNodeType.getAttribute('lnClass')}</span\n              ><span slot=\"secondary\"\n                >${isDisabled\n                  ? get('lnode.wizard.uniquewarning')\n                  : identity(lNodeType)}</span\n              ></mwc-check-list-item\n            >`;\n          })}</filtered-list\n        >`,\n      ],\n    },\n  ];\n}\n\n/** Description of a `ListItem` representing an `IED` or `LN[0]` */\ninterface ItemDescription {\n  selected: boolean;\n  disabled?: boolean;\n  preferred?: boolean;\n  element?: Element;\n}\n\n/** Logical nodes perferred for lnode reference to substation element */\nconst preferredLn: Partial<Record<string, string[]>> = {\n  CBR: ['CSWI', 'CILO', 'XCBR'],\n  DIS: ['CSWI', 'CILO', 'XSWI'],\n  VTR: ['TVTR'],\n  CTR: ['TCTR'],\n  Bay: ['LLN0'],\n  VoltageLevel: ['LLN0'],\n  Substation: ['LLN0'],\n};\n\n/** Sorts selected `ListItem`s to the top and disabled ones to the bottom. */\nfunction compare(a: ItemDescription, b: ItemDescription): number {\n  if (a.disabled !== b.disabled) return b.disabled ? -1 : 1;\n\n  if (a.preferred !== b.preferred) return a.preferred ? -1 : 1;\n\n  if (a.selected !== b.selected) return a.selected ? -1 : 1;\n\n  return 0;\n}\n\nconst APldInst = 'Client LN';\n\n/** Queries `parent` for an `LNode` described by logical node element. */\nexport function getLNode(\n  parent: Element | XMLDocument,\n  anyln: Element\n): Element | null {\n  return (\n    Array.from(parent.getElementsByTagName('LNode'))\n      .filter(item => !item.closest('Private'))\n      .filter(lnode => isLNodeReference(anyln, lnode))[0] ?? null\n  );\n}\n\nfunction isLNodeReference(anyln: Element, lnode: Element): boolean {\n  return (\n    (lnode.getAttribute('iedName') ?? '') ===\n      (anyln.closest('IED')?.getAttribute('name') ?? '') &&\n    (lnode.getAttribute('ldInst') ?? '') ===\n      (anyln.closest('LDevice')?.getAttribute('inst') ?? '') &&\n    (lnode.getAttribute('prefix') ?? '') ===\n      (anyln.getAttribute('prefix') ?? '') &&\n    (lnode.getAttribute('lnClass') ?? '') ===\n      (anyln.getAttribute('lnClass') ?? '') &&\n    (lnode.getAttribute('lnInst') ?? '') === (anyln.getAttribute('inst') ?? '')\n  );\n}\n\nfunction createAction(parent: Element, anyln: Element): EditorAction {\n  const element = createElement(parent.ownerDocument, 'LNode', {\n    iedName: anyln.closest('IED')?.getAttribute('name') ?? '',\n    ldInst: anyln.closest('LDevice')?.getAttribute('inst') ?? '',\n    prefix: anyln.getAttribute('prefix') ?? '',\n    lnClass: anyln.getAttribute('lnClass') ?? '',\n    lnInst: anyln.getAttribute('inst') ?? '',\n  });\n\n  return {\n    new: {\n      parent,\n      element,\n    },\n  };\n}\n\nfunction deleteAction(parent: Element, lnode: Element): EditorAction {\n  return {\n    old: {\n      parent: parent,\n      element: lnode,\n      reference: lnode.nextElementSibling,\n    },\n  };\n}\n\nfunction includesAnyLN(anylns: Element[], lnode: Element): boolean {\n  return anylns.some(anyln => isLNodeReference(anyln, lnode));\n}\n\nfunction includesLNode(anyln: Element, lnodes: Element[]): boolean {\n  return lnodes.some(lnode => isLNodeReference(anyln, lnode));\n}\n\n/**\n * @returns a `WizardAction` updating `parent`'s `LNodes`\n * to the entries selected in `wizard`'s `#lnList`.\n */\nexport function lNodeWizardAction(parent: Element): WizardActor {\n  return (\n    inputs: WizardInputElement[],\n    wizard: Element,\n    list?: List | null\n  ): EditorAction[] => {\n    const selectedAnyLn = <Element[]>list!.items\n      .filter(item => item.selected)\n      .map(item => item.value)\n      .map(identity => {\n        const ln0 = find(parent.ownerDocument, 'LN0', identity);\n        if (ln0) return ln0;\n        return find(parent.ownerDocument, 'LN', identity);\n      })\n      .filter(item => item !== null);\n\n    const oldLNodes = getChildElementsByTagName(parent, 'LNode').filter(\n      isPublic\n    );\n\n    const deleteActions = oldLNodes\n      .filter(lnode => !includesAnyLN(selectedAnyLn, lnode))\n      .map(lnode => deleteAction(parent, lnode));\n    const createActions = selectedAnyLn\n      .filter(anyln => !includesLNode(anyln, oldLNodes))\n      .map(anyln => createAction(parent, anyln));\n\n    return deleteActions.concat(createActions);\n  };\n}\n\nfunction getListContainer(target: Element, selector: string): Element | null {\n  return (\n    target.parentElement?.parentElement?.nextElementSibling?.querySelector(\n      selector\n    ) ?? null\n  );\n}\n\nfunction onIEDSelect(evt: MultiSelectedEvent, parent: Element): void {\n  if (!(evt.target instanceof ListBase)) return;\n  const lnList = getListContainer(evt.target, '#lnList');\n  if (lnList === null) return;\n\n  const doc = parent.ownerDocument;\n\n  const selectedIEDItems = <ListItem[]>evt.target.selected;\n\n  const lnItems = selectedIEDItems\n    .flatMap(item =>\n      Array.from(\n        doc.querySelectorAll(\n          `:root > IED[name=\"${item.value}\"] > AccessPoint > LN,` +\n            `:root > IED[name=\"${item.value}\"] > AccessPoint > Server > LDevice > LN,` +\n            `:root > IED[name=\"${item.value}\"] > AccessPoint > Server > LDevice > LN0`\n        )\n      ).filter(item => !item.closest('Private'))\n    )\n    .filter(item => item !== null)\n    .map(item => {\n      const isPrefered =\n        preferredLn[\n          parent.getAttribute('type')\n            ? parent.getAttribute('type') ?? ''\n            : parent.tagName ?? ''\n        ]?.includes(item.getAttribute('lnClass') ?? '') ?? false;\n\n      const lnode = getLNode(parent.ownerDocument, item);\n      const selected = lnode?.parentElement === parent;\n\n      return {\n        selected,\n        disabled: lnode !== null && !selected,\n        prefered: isPrefered,\n        element: item,\n      };\n    })\n    .sort(compare);\n\n  const lnTemplates = lnItems.map(item => {\n    return html`<mwc-check-list-item\n      ?selected=${item.selected}\n      ?disabled=${item.disabled}\n      value=\"${identity(item.element)}\"\n      twoline\n      ><span\n        >${item.element.getAttribute('prefix') ??\n        ''}${item.element.getAttribute('lnClass')}${item.element.getAttribute(\n          'inst'\n        ) ?? ''}\n        ${item.disabled\n          ? html` <mwc-icon style=\"--mdc-icon-size: 1em;\"\n                >account_tree</mwc-icon\n              >\n              ${referencePath(getLNode(doc, item.element)!)}`\n          : ''}</span\n      ><span slot=\"secondary\"\n        >${item.element.closest('IED')?.getAttribute('name') ?? ''} |\n        ${item.element.closest('LDevice')\n          ? item.element.closest('LDevice')?.getAttribute('inst')\n          : APldInst}</span\n      ></mwc-check-list-item\n    >`;\n  });\n\n  render(html`${lnTemplates}`, lnList);\n}\n\nfunction renderIEDPage(element: Element): TemplateResult {\n  const doc = element.ownerDocument;\n  if (doc.querySelectorAll(':root > IED').length > 0)\n    return html`<filtered-list\n      disableCheckAll\n      multi\n      id=\"iedList\"\n      @selected=${(evt: MultiSelectedEvent) => onIEDSelect(evt, element)}\n      >${Array.from(doc.querySelectorAll(':root > IED'))\n        .map(ied => ied.getAttribute('name')!)\n        .map(iedName => {\n          return {\n            selected:\n              Array.from(element.children)\n                .filter(item => !item.closest('Private'))\n                .filter(\n                  item =>\n                    item.tagName === 'LNode' &&\n                    item.getAttribute('iedName') === iedName\n                ).length > 0,\n            iedName: iedName,\n          };\n        })\n        .sort(compare)\n        .map(\n          item =>\n            html`<mwc-check-list-item\n              value=\"${item.iedName ?? ''}\"\n              ?selected=${item.selected}\n              >${item.iedName}</mwc-check-list-item\n            >`\n        )}</filtered-list\n    >`;\n  else\n    return html`<mwc-list-item noninteractive graphic=\"icon\">\n      <span>${get('lnode.wizard.placeholder')}</span>\n      <mwc-icon slot=\"graphic\">info</mwc-icon>\n    </mwc-list-item>`;\n}\n\nfunction openLNodeInstanceWizard(parent: Element): WizardMenuActor {\n  return (wizard: Element): void => {\n    wizard.dispatchEvent(newWizardEvent());\n    wizard.dispatchEvent(newWizardEvent(lNodeInstanceWizard(parent)));\n  };\n}\n\nfunction lNodeReferenceWizard(parent: Element): Wizard {\n  return [\n    {\n      title: get('lnode.wizard.title.selectIEDs'),\n      menuActions: [\n        {\n          icon: '',\n          label: get('lnode.wizard.instance'),\n          action: openLNodeInstanceWizard(parent),\n        },\n      ],\n      content: [renderIEDPage(parent)],\n    },\n    {\n      initial: Array.from(parent.children).some(\n        child => child.tagName === 'LNode'\n      ),\n      title: get('lnode.wizard.title.selectLNs'),\n      primary: {\n        icon: 'save',\n        label: get('save'),\n        action: lNodeWizardAction(parent),\n      },\n      content: [html`<filtered-list multi id=\"lnList\"></filtered-list>`],\n    },\n  ];\n}\n\n/** @returns a Wizard for editing `element`'s `LNode` children. */\nexport function lNodeWizard(parent: Element): Wizard {\n  if (\n    parent.tagName === 'Function' ||\n    parent.tagName === 'SubFunction' ||\n    parent.tagName === 'EqFunction' ||\n    parent.tagName === 'EqSubFunction'\n  )\n    return lNodeInstanceWizard(parent);\n\n  return lNodeReferenceWizard(parent);\n}\n\ninterface ContentOptions {\n  iedName: string | null;\n  ldInst: string | null;\n  prefix: string | null;\n  lnClass: string | null;\n  lnInst: string | null;\n  reservedLnInst: string[];\n}\n\nfunction contentLNodeWizard(options: ContentOptions): TemplateResult[] {\n  const isIedRef = options.iedName !== 'None';\n\n  return [\n    html`<wizard-textfield\n      label=\"iedName\"\n      .maybeValue=${options.iedName}\n      helper=\"${get('scl.iedName')}\"\n      helperPersistent\n      disabled\n    ></wizard-textfield>`,\n    html`<wizard-textfield\n      label=\"ldInst\"\n      .maybeValue=${options.ldInst}\n      helper=\"${get('scl.ldInst')}\"\n      helperPersistent\n      nullable\n      disabled\n    ></wizard-textfield>`,\n    html`<wizard-textfield\n      label=\"prefix\"\n      .maybeValue=${options.prefix}\n      helper=\"${get('scl.prefix')}\"\n      pattern=\"${patterns.asciName}\"\n      maxLength=\"11\"\n      helperPersistent\n      nullable\n      ?disabled=${isIedRef}\n    ></wizard-textfield>`,\n    html`<wizard-textfield\n      label=\"lnClass\"\n      .maybeValue=${options.lnClass}\n      helper=\"${get('scl.lnClass')}\"\n      helperPersistent\n      disabled\n    ></wizard-textfield>`,\n    html`<wizard-textfield\n      label=\"lnInst\"\n      .maybeValue=${options.lnInst}\n      helper=\"${get('scl.lnInst')}\"\n      helperPersistent\n      type=\"number\"\n      min=\"1\"\n      max=\"99\"\n      .reservedValues=${options.reservedLnInst}\n      ?disabled=${isIedRef}\n    ></wizard-textfield>`,\n  ];\n}\n\nfunction updateLNodeAction(element: Element): WizardActor {\n  return (inputs: WizardInputElement[]): EditorAction[] => {\n    const attributes: Record<string, string | null> = {};\n    const attributeKeys = ['iedName', 'ldInst', 'prefix', 'lnClass', 'lnInst'];\n\n    attributeKeys.forEach(key => {\n      attributes[key] = getValue(inputs.find(i => i.label === key)!);\n    });\n\n    let lNodeAction: EditorAction | null = null;\n    if (\n      attributeKeys.some(key => attributes[key] !== element.getAttribute(key))\n    ) {\n      const newElement = cloneElement(element, attributes);\n      lNodeAction = {\n        old: { element },\n        new: { element: newElement },\n      };\n      return [lNodeAction];\n    }\n\n    return [];\n  };\n}\n\nexport function editLNodeWizard(element: Element): Wizard {\n  const [iedName, ldInst, prefix, lnClass, lnInst] = [\n    'iedName',\n    'ldInst',\n    'prefix',\n    'lnClass',\n    'lnInst',\n  ].map(attr => element.getAttribute(attr));\n\n  const reservedLnInst = getChildElementsByTagName(\n    element.parentElement,\n    'LNode'\n  )\n    .filter(\n      sibling =>\n        sibling !== element &&\n        sibling.getAttribute('lnClass') === element.getAttribute('lnClass')\n    )\n    .map(sibling => sibling.getAttribute('lnInst')!);\n\n  return [\n    {\n      title: get('wizard.title.edit', { tagName: 'LNode' }),\n      element,\n      primary: {\n        label: get('save'),\n        icon: 'save',\n        action: updateLNodeAction(element),\n      },\n      content: [\n        ...contentLNodeWizard({\n          iedName,\n          ldInst,\n          prefix,\n          lnClass,\n          lnInst,\n          reservedLnInst,\n        }),\n      ],\n    },\n  ];\n}\n"]}