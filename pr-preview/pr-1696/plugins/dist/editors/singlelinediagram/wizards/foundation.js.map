{"version":3,"file":"foundation.js","sourceRoot":"","sources":["../../../../src/editors/singlelinediagram/wizards/foundation.ts"],"names":[],"mappings":"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","sourcesContent":["import { html, TemplateResult } from 'lit-element';\nimport { get } from 'lit-translate';\n\nimport {\n  getValue,\n  WizardActor,\n  WizardInputElement,\n} from '@openscd/open-scd/src/foundation.js';\n\nimport {\n  cloneElement\n} from '@openscd/xml';\n\nimport { EditorAction } from '@openscd/core/foundation/deprecated/editor.js';\nimport { SCL_COORDINATES_NAMESPACE } from '../foundation.js';\n\nexport function getNameAttribute(element: Element): string | null {\n  return element.getAttribute('name');\n}\n\nexport function getDescAttribute(element: Element): string | null {\n  return element.getAttribute('desc');\n}\n\nexport function getXCoordinateAttribute(element: Element): string | null {\n  return element.getAttributeNS(SCL_COORDINATES_NAMESPACE, 'x');\n}\n\nexport function getYCoordinateAttribute(element: Element): string | null {\n  return element.getAttributeNS(SCL_COORDINATES_NAMESPACE, 'y');\n}\n\nexport function getFixedCoordinateValue(value: string | null): string | null {\n  if (value === null) {\n    return value;\n  }\n\n  let convertedValue = Number(value);\n  if (isNaN(convertedValue) || convertedValue < 0) {\n    convertedValue = 0;\n  }\n\n  return convertedValue.toString();\n}\n\nfunction updateXYAttribute(\n  element: Element,\n  attributeName: string,\n  value: string | null\n): void {\n  if (value === null) {\n    element.removeAttributeNS(SCL_COORDINATES_NAMESPACE, attributeName);\n  } else {\n    element.setAttributeNS(SCL_COORDINATES_NAMESPACE, attributeName, value);\n  }\n}\n\nexport function updateNamingAndCoordinatesAction(\n  element: Element\n): WizardActor {\n  return (inputs: WizardInputElement[]): EditorAction[] => {\n    const name = getValue(inputs.find(i => i.label === 'name')!)!;\n    const desc = getValue(inputs.find(i => i.label === 'desc')!);\n    const xCoordinate = getValue(inputs.find(i => i.label === 'xCoordinate')!);\n    const yCoordinate = getValue(inputs.find(i => i.label === 'yCoordinate')!);\n\n    if (\n      name === getNameAttribute(element) &&\n      desc === getDescAttribute(element) &&\n      xCoordinate === getXCoordinateAttribute(element) &&\n      yCoordinate === getYCoordinateAttribute(element)\n    ) {\n      return [];\n    }\n\n    const newElement = cloneElement(element, { name, desc });\n    updateXYAttribute(newElement, 'x', getFixedCoordinateValue(xCoordinate));\n    updateXYAttribute(newElement, 'y', getFixedCoordinateValue(yCoordinate));\n\n    return [{ old: { element }, new: { element: newElement } }];\n  };\n}\n\nexport function renderXYCoordinateFields(\n  xCoordinate: string | null,\n  yCoordinate: string | null\n): TemplateResult[] {\n  return [\n    html`<wizard-textfield\n      label=\"xCoordinate\"\n      nullable\n      .maybeValue=${xCoordinate}\n      helper=\"${get('sld.wizard.xCoordinateHelper')}\"\n    ></wizard-textfield>`,\n    html`<wizard-textfield\n      label=\"yCoordinate\"\n      .maybeValue=${yCoordinate}\n      nullable\n      helper=\"${get('sld.wizard.yCoordinateHelper')}\"\n    ></wizard-textfield>`,\n  ];\n}\n"]}