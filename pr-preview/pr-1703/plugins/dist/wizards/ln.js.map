{"version":3,"file":"ln.js","sourceRoot":"","sources":["../../src/wizards/ln.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,IAAI,EAAkB,MAAM,aAAa,CAAC;AACnD,OAAO,EAAE,GAAG,EAAE,MAAM,eAAe,CAAC;AAEpC,OAAO,2CAA2C,CAAC;AACnD,OAAO,EACL,QAAQ,GAIT,MAAM,qCAAqC,CAAC;AAE7C,OAAO,EAAE,YAAY,EAAE,MAAM,cAAc,CAAC;AAK5C,MAAM,UAAU,cAAc,CAC5B,MAAqB,EACrB,IAAmB,EACnB,MAAqB,EACrB,OAAsB,EACtB,IAAmB;IAEnB,OAAO;QACL,IAAI,CAAA;;oBAEY,MAAM;;;gBAGV,GAAG,CAAC,wBAAwB,CAAC;yBACpB;QACrB,IAAI,CAAA;;oBAEY,IAAI;;gBAER,GAAG,CAAC,sBAAsB,CAAC;yBAClB;QACrB,IAAI,CAAA;;;;oBAIY,MAAM;gBACV,GAAG,CAAC,wBAAwB,CAAC;yBACpB;QACrB,IAAI,CAAA;;;;oBAIY,OAAO;gBACX,GAAG,CAAC,yBAAyB,CAAC;yBACrB;QACrB,IAAI,CAAA;;oBAEY,IAAI;;gBAER,GAAG,CAAC,sBAAsB,CAAC;yBAClB;KACtB,CAAC;AACJ,CAAC;AAED,SAAS,YAAY,CAAC,OAAgB;IACpC,OAAO,CAAC,MAA4B,EAAkB,EAAE;QACtD,MAAM,OAAO,GAAkC,EAAE,CAAC;QAClD,MAAM,MAAM,GAAG,CAAC,QAAQ,EAAE,MAAM,EAAE,QAAQ,EAAE,SAAS,EAAE,MAAM,CAAC,CAAC;QAC/D,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE;YACnB,OAAO,CAAC,GAAG,CAAC,GAAG,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,KAAK,KAAK,GAAG,CAAE,CAAC,CAAC;QAC9D,CAAC,CAAC,CAAC;QAEH,IAAI,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC,EAAE;YAClE,MAAM,UAAU,GAAG,YAAY,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;YAClD,OAAO;gBACL;oBACE,GAAG,EAAE,EAAE,OAAO,EAAE;oBAChB,GAAG,EAAE,EAAE,OAAO,EAAE,UAAU,EAAE;iBAC7B;aACF,CAAC;SACH;QACD,OAAO,EAAE,CAAC;IACZ,CAAC,CAAC;AACJ,CAAC;AAGD,MAAM,UAAU,YAAY,CAAC,OAAgB;IAC3C,OAAO;QACL;YACE,KAAK,EAAE,GAAG,CAAC,sBAAsB,CAAC;YAClC,OAAO;YACP,OAAO,EAAE;gBACP,IAAI,EAAE,MAAM;gBACZ,KAAK,EAAE,GAAG,CAAC,MAAM,CAAC;gBAClB,MAAM,EAAE,YAAY,CAAC,OAAO,CAAC;aAC9B;YACD,OAAO,EAAE,cAAc,CACrB,OAAO,CAAC,YAAY,CAAC,QAAQ,CAAC,EAC9B,OAAO,CAAC,YAAY,CAAC,MAAM,CAAC,EAC5B,OAAO,CAAC,YAAY,CAAC,QAAQ,CAAC,EAC9B,OAAO,CAAC,YAAY,CAAC,SAAS,CAAC,EAC/B,OAAO,CAAC,YAAY,CAAC,MAAM,CAAC,CAC7B;SACF;KACF,CAAC;AACJ,CAAC","sourcesContent":["import { html, TemplateResult } from 'lit-element';\nimport { get } from 'lit-translate';\n\nimport '@openscd/open-scd/src/wizard-textfield.js';\nimport {\n  getValue,\n  Wizard,\n  WizardActor,\n  WizardInputElement,\n} from '@openscd/open-scd/src/foundation.js';\n\nimport { cloneElement } from '@openscd/xml';\n\nimport { SimpleAction } from '@openscd/core/foundation/deprecated/editor.js';\nimport { patterns } from './foundation/limits.js';\n\nexport function renderLNWizard(\n  lnType: string | null,\n  desc: string | null,\n  prefix: string | null,\n  lnClass: string | null,\n  inst: string | null\n): TemplateResult[] {\n  return [\n    html`<wizard-textfield\n      label=\"lnType\"\n      .maybeValue=${lnType}\n      readonly\n      required\n      helper=\"${get('ln.wizard.lnTypeHelper')}\"\n    ></wizard-textfield>`,\n    html`<wizard-textfield\n      label=\"desc\"\n      .maybeValue=${desc}\n      nullable\n      helper=\"${get('ln.wizard.descHelper')}\"\n    ></wizard-textfield>`,\n    html`<wizard-textfield\n      label=\"prefix\"\n      nullable\n      readonly\n      .maybeValue=${prefix}\n      helper=\"${get('ln.wizard.prefixHelper')}\"\n    ></wizard-textfield>`,\n    html`<wizard-textfield\n      label=\"lnClass\"\n      readonly\n      required\n      .maybeValue=${lnClass}\n      helper=\"${get('ln.wizard.lnClassHelper')}\"\n    ></wizard-textfield>`,\n    html`<wizard-textfield\n      label=\"inst\"\n      .maybeValue=${inst}\n      readonly\n      helper=\"${get('ln.wizard.instHelper')}\"\n    ></wizard-textfield>`,\n  ];\n}\n\nfunction updateAction(element: Element): WizardActor {\n  return (inputs: WizardInputElement[]): SimpleAction[] => {\n    const ldAttrs: Record<string, string | null> = {};\n    const ldKeys = ['lnType', 'desc', 'prefix', 'lnClass', 'inst'];\n    ldKeys.forEach(key => {\n      ldAttrs[key] = getValue(inputs.find(i => i.label === key)!);\n    });\n\n    if (ldKeys.some(key => ldAttrs[key] !== element.getAttribute(key))) {\n      const newElement = cloneElement(element, ldAttrs);\n      return [\n        {\n          old: { element },\n          new: { element: newElement },\n        },\n      ];\n    }\n    return [];\n  };\n}\n\n\nexport function editLNWizard(element: Element): Wizard {\n  return [\n    {\n      title: get('ln.wizard.title.edit'),\n      element,\n      primary: {\n        icon: 'edit',\n        label: get('save'),\n        action: updateAction(element),\n      },\n      content: renderLNWizard(\n        element.getAttribute('lnType'),\n        element.getAttribute('desc'),\n        element.getAttribute('prefix'),\n        element.getAttribute('lnClass'),\n        element.getAttribute('inst')\n      ),\n    },\n  ];\n}\n"]}