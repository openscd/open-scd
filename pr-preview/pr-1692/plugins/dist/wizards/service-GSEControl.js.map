{"version":3,"file":"service-GSEControl.js","sourceRoot":"","sources":["../../src/wizards/service-GSEControl.ts"],"names":[],"mappings":"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","sourcesContent":["import { TemplateResult } from 'lit-html';\nimport { get } from 'lit-translate';\nimport { WizardPage } from '@openscd/open-scd/src/foundation.js';\n\nimport {\n  createFormDivider,\n  createFormElementsFromInputs,\n  isEmptyObject,\n} from './services.js';\n\ninterface GSESettings {\n  cbName: string | null;\n  datSet: string | null;\n  appID: string | null;\n  dataLabel: string | null;\n  kdaParticipant: string | null;\n  signature: string | null;\n  encryption: string | null;\n}\n\ninterface GOOSE {\n  max: string | null;\n  fixedOffs: string | null;\n  goose: string | null;\n  rGOOSE: string | null;\n}\n\ninterface ClientServices {\n  maxGOOSE: string | null;\n  goose: string | null;\n  rGOOSE: string | null;\n  gsse: string | null;\n}\n\ninterface SupSubscription {\n  maxGo: string | null;\n  maxSv: string | null;\n}\n\ninterface GSSE {\n  max: string | null;\n}\n\ninterface ContentOptions {\n  gseSettings: GSESettings;\n  goose: GOOSE;\n  clientServices: ClientServices;\n  supSubscription: SupSubscription;\n  gsse: GSSE;\n}\n\nexport function createGSEControlWizardPage(\n  services: Element\n): WizardPage | null {\n  const content: TemplateResult[] | null = createGSEControlWizard(services);\n\n  return content\n    ? {\n        title: get('wizard.title.edit', { tagName: 'GSE Control' }),\n        content: [...content],\n        element: services,\n      }\n    : null;\n}\n\nfunction createGSEControlWizard(parent: Element): TemplateResult[] | null {\n  const content: ContentOptions = {\n    gseSettings: {\n      cbName:\n        parent.querySelector('GSESettings')?.getAttribute('cbName') ?? null,\n      datSet:\n        parent.querySelector('GSESettings')?.getAttribute('datSet') ?? null,\n      appID: parent.querySelector('GSESettings')?.getAttribute('appID') ?? null,\n      dataLabel:\n        parent.querySelector('GSESettings')?.getAttribute('dataLabel') ?? null,\n      kdaParticipant:\n        parent.querySelector('GSESettings')?.getAttribute('kdaParticipant') ??\n        null,\n      signature:\n        parent\n          .querySelector('GSESettings > McSecurity')\n          ?.getAttribute('signature') ?? null,\n      encryption:\n        parent\n          .querySelector('GSESettings > McSecurity')\n          ?.getAttribute('encryption') ?? null,\n    },\n    goose: {\n      max: parent.querySelector('GOOSE')?.getAttribute('max') ?? null,\n      fixedOffs:\n        parent.querySelector('GOOSE')?.getAttribute('fixedOffs') ?? null,\n      goose: parent.querySelector('GOOSE')?.getAttribute('goose') ?? null,\n      rGOOSE: parent.querySelector('GOOSE')?.getAttribute('rGOOSE') ?? null,\n    },\n    clientServices: {\n      maxGOOSE:\n        parent.querySelector('ClientServices')?.getAttribute('maxGOOSE') ??\n        null,\n      goose:\n        parent.querySelector('ClientServices')?.getAttribute('goose') ?? null,\n      rGOOSE:\n        parent.querySelector('ClientServices')?.getAttribute('rGOOSE') ?? null,\n      gsse:\n        parent.querySelector('ClientServices')?.getAttribute('gsse') ?? null,\n    },\n    supSubscription: {\n      maxGo:\n        parent.querySelector('SupSubscription')?.getAttribute('maxGo') ?? null,\n      maxSv:\n        parent.querySelector('SupSubscription')?.getAttribute('maxSv') ?? null,\n    },\n    gsse: {\n      max: parent.querySelector('GSSE')?.getAttribute('max') ?? null,\n    },\n  };\n\n  return isEmptyObject(content)\n    ? null\n    : [\n        createFormDivider('Control Block Configuration'),\n        ...createFormElementsFromInputs([\n          {\n            kind: 'Select',\n            label: 'cbName',\n            maybeValue: content.gseSettings.cbName,\n            helper:\n              'Whether GSE control block (GOOSE) name is configurable offline (Conf) or fixed (Fix)',\n            values: ['Conf', 'Fix'],\n            default: 'Fix',\n            nullable: true,\n          },\n          {\n            kind: 'Select',\n            label: 'datSet',\n            maybeValue: content.gseSettings.datSet,\n            helper:\n              'Whether GSE control blocks (GOOSE) data set and its structure is configurable offline (Conf), online(Dyn) or is fixed (Fix)',\n            values: ['Dyn', 'Conf', 'Fix'],\n            default: 'Fix',\n            nullable: true,\n          },\n          {\n            kind: 'Select',\n            label: 'appID',\n            maybeValue: content.gseSettings.appID,\n            helper:\n              'Whether GSE control blocks (GOOSE) ID is configurable offline (Conf), online(Dyn) or is fixed (Fix)',\n            values: ['Dyn', 'Conf', 'Fix'],\n            default: 'Fix',\n            nullable: true,\n          },\n          {\n            kind: 'Select',\n            label: 'dataLabel',\n            maybeValue: content.gseSettings.dataLabel,\n            helper:\n              'Deprecated!: Whether GSSE object reference is configurable offline (Conf), online(Dyn) or are fixed (Fix)',\n            values: ['Dyn', 'Conf', 'Fix'],\n            default: 'Fix',\n            nullable: true,\n          },\n          {\n            kind: 'Checkbox',\n            label: 'kdaParticipant',\n            maybeValue: content.gseSettings.kdaParticipant,\n            helper:\n              'Whether key delivery assurance (KDA) is supported by the server',\n            nullable: true,\n          },\n          {\n            kind: 'Checkbox',\n            label: 'signature',\n            helper:\n              'Whether calculation of a signature is supported for each GOOSE',\n            maybeValue: content.gseSettings.signature,\n            nullable: true,\n            default: false,\n          },\n          {\n            kind: 'Checkbox',\n            label: 'encryption',\n            helper: 'Whether message encryption is supported for each GOOSE',\n            maybeValue: content.gseSettings.encryption,\n            nullable: true,\n            default: false,\n          },\n        ]),\n        createFormDivider('Publisher Capabilities'),\n        ...createFormElementsFromInputs([\n          {\n            kind: 'TextField',\n            label: 'max',\n            required: true,\n            helper:\n              'The maximum number of configurable GOOSE control blocks. 0 means no GOOSE publishing supported',\n            maybeValue: content.goose.max?.toString() ?? null,\n            nullable: true,\n          },\n          {\n            kind: 'Checkbox',\n            label: 'fixedOffs',\n            maybeValue: content.goose.fixedOffs,\n            helper:\n              'Whether encoding with fixed offsets is configurable for each GSE control block (GOOSE). See also IEC 61850-8-1',\n            nullable: true,\n            default: false,\n          },\n          {\n            kind: 'Checkbox',\n            label: 'goose',\n            helper: 'Whether GOOSE publishing is supported',\n            maybeValue: content.goose.goose,\n            nullable: true,\n            default: true,\n          },\n          {\n            kind: 'Checkbox',\n            label: 'rGOOSE',\n            helper: 'Whether GOOSE with network layer 3 (IP) is supported',\n            maybeValue: content.goose.rGOOSE,\n            nullable: true,\n            default: false,\n          },\n        ]),\n        createFormDivider('Subscription Capabilities'),\n        ...createFormElementsFromInputs([\n          {\n            kind: 'Checkbox',\n            label: 'goose',\n            helper:\n              'Whether the IED supports client side GOOSE related services',\n            maybeValue: content.clientServices.goose?.toString() ?? null,\n            nullable: true,\n            default: false,\n          },\n          {\n            kind: 'TextField',\n            label: 'maxGOOSE',\n            required: true,\n            helper: 'The maximal number of GOOSEs the client can subscribe to',\n            maybeValue: content.clientServices.maxGOOSE?.toString() ?? null,\n            nullable: true,\n          },\n          {\n            kind: 'Checkbox',\n            label: 'rGOOSE',\n            helper:\n              'The maximal number of GOOSEs with network layer 3 the client can subscribe to',\n            maybeValue: content.clientServices.rGOOSE?.toString() ?? null,\n            nullable: true,\n            default: false,\n          },\n          {\n            kind: 'Checkbox',\n            label: 'gsse',\n            helper:\n              'Whether the IED supports client side GSSE related services',\n            maybeValue: content.clientServices.gsse?.toString() ?? null,\n            nullable: true,\n            default: false,\n          },\n        ]),\n        createFormDivider('Supervision Capabilities'),\n        ...createFormElementsFromInputs([\n          {\n            kind: 'TextField',\n            label: 'maxGo',\n            required: false,\n            helper:\n              'The maximum number of GOOSE supervision supported by this IED (LGOS)',\n            maybeValue: content.supSubscription.maxGo?.toString() ?? null,\n            nullable: true,\n          },\n        ]),\n        createFormDivider('GSSE Capabilities'),\n        ...createFormElementsFromInputs([\n          {\n            kind: 'TextField',\n            label: 'max',\n            required: true,\n            helper:\n              'The maximum number of GSSE supported as publisher. 0 means IED can only subscribe on GSSE messages',\n            maybeValue: content.gsse.max?.toString() ?? null,\n            nullable: true,\n          },\n        ]),\n      ];\n}\n"]}