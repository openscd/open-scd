{"version":3,"file":"add-ldevice-dialog.js","sourceRoot":"","sources":["../../../src/editors/ied/add-ldevice-dialog.ts"],"names":[],"mappings":"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","sourcesContent":["import {\r\n  css,\r\n  customElement,\r\n  html,\r\n  LitElement,\r\n  property,\r\n  query,\r\n  state,\r\n  TemplateResult,\r\n} from 'lit-element';\r\nimport { translate, get } from 'lit-translate';\r\n\r\nimport { Dialog } from '@material/mwc-dialog';\r\nimport '@material/mwc-dialog';\r\nimport '@material/mwc-textfield';\r\nimport '@material/mwc-button';\r\n\r\nimport { getLDeviceInsts } from './foundation';\r\n\r\nexport interface LDeviceData {\r\n  inst: string;\r\n}\r\n\r\n/** Dialog for adding a new LDevice to a Server. */\r\n@customElement('add-ldevice-dialog')\r\nexport class AddLDeviceDialog extends LitElement {\r\n  @property({ type: Boolean })\r\n  open = false;\r\n\r\n  @property()\r\n  server!: Element;\r\n\r\n  @property({ type: Function })\r\n  onConfirm!: (data: LDeviceData) => void;\r\n\r\n  @query('#addLDeviceDialog') dialog!: Dialog;\r\n\r\n  @state()\r\n  private inst: string = '';\r\n\r\n  connectedCallback(): void {\r\n    super.connectedCallback();\r\n  }\r\n\r\n  public show(): void {\r\n    this.inst = '';\r\n    this.dialog.show();\r\n  }\r\n\r\n  private close(): void {\r\n    this.dialog.close();\r\n  }\r\n\r\n  private handleCreate(): void {\r\n    const data: LDeviceData = {\r\n      inst: this.inst,\r\n    };\r\n    this.onConfirm(data);\r\n    this.close();\r\n  }\r\n\r\n  private get lDeviceInst(): string[] {\r\n    return getLDeviceInsts(this.server);\r\n  }\r\n\r\n  private getInstError(value: string): string {\r\n    const trimmed = value.trim();\r\n    if (!trimmed) return '';\r\n    if (!/^[A-Za-z0-9][0-9A-Za-z_]*$/.test(trimmed))\r\n      return get('iededitor.addLDeviceDialog.instFormatError');\r\n    if (trimmed.length > 64)\r\n      return get('iededitor.addLDeviceDialog.instTooLongError');\r\n    if (this.lDeviceInst.includes(trimmed))\r\n      return get('iededitor.addLDeviceDialog.instUniqueError');\r\n    return '';\r\n  }\r\n\r\n  render(): TemplateResult {\r\n    const error = this.getInstError(this.inst);\r\n    return html`\r\n      <mwc-dialog\r\n        id=\"addLDeviceDialog\"\r\n        heading=${translate('iededitor.addLDeviceDialog.title')}\r\n        @closed=${this.close}\r\n      >\r\n        <div class=\"dialog-content\">\r\n          <mwc-textfield\r\n            label=${translate('iededitor.addLDeviceDialog.inst')}\r\n            helper=${translate('iededitor.addLDeviceDialog.inst')}\r\n            .value=${this.inst}\r\n            .validationMessage=${error}\r\n            .validityTransform=${(value: string) => {\r\n              const err = this.getInstError(value);\r\n              return {\r\n                valid: err === '',\r\n                customError: err !== '',\r\n              };\r\n            }}\r\n            pattern=\"[A-Za-z0-9][0-9A-Za-z_]*\"\r\n            maxLength=\"64\"\r\n            required\r\n            autoValidate\r\n            dialogInitialFocus\r\n            @input=${(e: Event) => {\r\n              this.inst = (e.target as HTMLInputElement).value;\r\n            }}\r\n            style=\"width: 100%;\"\r\n          ></mwc-textfield>\r\n        </div>\r\n        <mwc-button\r\n          slot=\"secondaryAction\"\r\n          @click=${this.close}\r\n          style=\"--mdc-theme-primary: var(--mdc-theme-error)\"\r\n        >\r\n          ${translate('close')}\r\n        </mwc-button>\r\n        <mwc-button\r\n          slot=\"primaryAction\"\r\n          icon=\"add\"\r\n          trailingIcon\r\n          ?disabled=${!!error}\r\n          @click=${this.handleCreate}\r\n        >\r\n          ${translate('add')}\r\n        </mwc-button>\r\n      </mwc-dialog>\r\n    `;\r\n  }\r\n  static styles = css`\r\n    .dialog-content {\r\n      margin-top: 16px;\r\n      width: 320px;\r\n      max-width: 100vw;\r\n      box-sizing: border-box;\r\n    }\r\n  `;\r\n}\r\n"]}