{"version":3,"file":"subnetwork-container.js","sourceRoot":"","sources":["../../../src/editors/protocol104/subnetwork-container.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  css,\n  customElement,\n  html,\n  property,\n  TemplateResult,\n} from 'lit-element';\n\nimport '@material/mwc-icon-button';\n\nimport './connectedap-editor.js';\n\nimport {\n  compareNames,\n  newWizardEvent,\n} from '@openscd/open-scd/src/foundation.js';\nimport { get } from 'lit-translate';\nimport { createConnectedApWizard } from './wizards/connectedap.js';\nimport { Base104Container } from './base-container.js';\nimport { getTypeAttribute } from './foundation/foundation.js';\n\n/** [[`104`]] subeditor for a `SubNetwork` element. */\n@customElement('subnetwork-104-container')\nexport class SubNetwork104Container extends Base104Container {\n  /** SCL element SubNetwork */\n  @property({ attribute: false })\n  element!: Element;\n\n  get bitrate(): string | null {\n    const bitRate = this.element.querySelector('BitRate');\n    if (bitRate === null) return null;\n    const bitRateValue = bitRate.textContent ?? '';\n    const m = bitRate.getAttribute('multiplier');\n    const unit = m === null ? 'b/s' : ' ' + m + 'b/s';\n    return bitRateValue ? bitRateValue + unit : null;\n  }\n\n  private openConnectedAPwizard(): void {\n    this.dispatchEvent(newWizardEvent(createConnectedApWizard(this.element)));\n  }\n\n  private renderIedContainer(): TemplateResult[] {\n    return Array.from(this.element.querySelectorAll(':scope > ConnectedAP'))\n      .map(connAP => connAP.getAttribute('iedName')!)\n      .filter((v, i, a) => a.indexOf(v) === i)\n      .sort(compareNames)\n      .map(\n        iedName => html` <action-pane id=\"iedSection\" label=\"${iedName}\">\n          ${Array.from(\n            this.element.parentElement?.querySelectorAll(\n              `:scope > SubNetwork > ConnectedAP[iedName=\"${iedName}\"]`\n            ) ?? []\n          ).map(\n            connectedAP =>\n              html`<connectedap-104-editor\n                class=\"${connectedAP.parentElement !== this.element\n                  ? 'disabled'\n                  : ''}\"\n                .editCount=${this.editCount}\n                .doc=\"${this.doc}\"\n                .element=${connectedAP}\n              ></connectedap-104-editor>`\n          )}\n        </action-pane>`\n      );\n  }\n\n  private subNetworkSpecs(): string {\n    const type = getTypeAttribute(this.element) ?? null;\n\n    if (!type && !this.bitrate) return '';\n\n    return `(${type}${type && this.bitrate ? ` — ${this.bitrate}` : ``})`;\n  }\n\n  private header(): string {\n    const desc = this.element.getAttribute('desc') ?? null;\n    const name = this.element.getAttribute('name') ?? undefined;\n\n    return ` ${name} ${desc === null ? '' : `— ${desc}`}\n    ${this.subNetworkSpecs()}`;\n  }\n\n  render(): TemplateResult {\n    return html`<action-pane label=\"${this.header()}\">\n      <abbr slot=\"action\" title=\"${get('add')}\">\n        <mwc-icon-button\n          icon=\"playlist_add\"\n          @click=\"${() => this.openConnectedAPwizard()}\"\n        ></mwc-icon-button>\n      </abbr>\n      <div id=\"iedContainer\">${this.renderIedContainer()}</div>\n    </action-pane> `;\n  }\n\n  static styles = css`\n    #iedContainer {\n      display: grid;\n      box-sizing: border-box;\n      gap: 12px;\n      padding: 8px 12px 16px;\n      grid-template-columns: repeat(auto-fit, minmax(150px, auto));\n    }\n\n    #iedSection:not(:focus):not(:focus-within) .disabled {\n      display: none;\n    }\n\n    #iedSection .disabled {\n      pointer-events: none;\n      opacity: 0.5;\n    }\n  `;\n}\n"]}