{"version":3,"file":"VirtualTemplateIED.js","sourceRoot":"","sources":["../../src/menu/VirtualTemplateIED.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  css,\n  html,\n  LitElement,\n  property,\n  query,\n  queryAll,\n  state,\n  TemplateResult,\n} from 'lit-element';\nimport { get } from 'lit-translate';\n\nimport '@material/mwc-dialog';\nimport '@material/mwc-list';\nimport '@material/mwc-list/mwc-list-item';\nimport '@material/mwc-list/mwc-check-list-item';\nimport '@material/mwc-list/mwc-radio-list-item';\nimport { Dialog } from '@material/mwc-dialog';\nimport { CheckListItem } from '@material/mwc-list/mwc-check-list-item';\nimport { Select } from '@material/mwc-select';\n\nimport '@openscd/open-scd/src/filtered-list.js';\nimport { find, identity } from '@openscd/open-scd/src/foundation.js';\nimport { getChildElementsByTagName } from '@openscd/xml';\n\nimport { newActionEvent } from '@openscd/core/foundation/deprecated/editor.js';\nimport { WizardTextField } from '@openscd/open-scd/src/wizard-textfield.js';\nimport {\n  getFunctionNamingPrefix,\n  getNonLeafParent,\n  getSpecificationIED,\n  getUniqueFunctionName,\n  LDeviceDescription,\n} from './virtualtemplateied/foundation.js';\n\nexport type FunctionElementDescription = {\n  uniqueName: string;\n  lNodes: Element[];\n  lln0?: Element;\n};\n\n/** converts FunctionElementDescription's to LDeviceDescription's */\nfunction getLDeviceDescriptions(\n  functions: Record<string, FunctionElementDescription>,\n  selectedLNodes: Element[],\n  selectedLLN0s: string[]\n): LDeviceDescription[] {\n  const lDeviceDescriptions: LDeviceDescription[] = [];\n\n  Object.values(functions).forEach(functionDescription => {\n    if (\n      functionDescription.lNodes.some(lNode => selectedLNodes.includes(lNode))\n    ) {\n      const lLN0 = selectedLLN0s.find(selectedLLN0 =>\n        selectedLLN0.includes(functionDescription.uniqueName)\n      )!;\n      const lnType = lLN0?.split(': ')[1];\n\n      lDeviceDescriptions.push({\n        validLdInst: functionDescription.uniqueName,\n        anyLNs: [\n          { prefix: null, lnClass: 'LLN0', inst: '', lnType },\n          ...functionDescription.lNodes\n            .filter(lNode => selectedLNodes.includes(lNode))\n            .map(lNode => {\n              return {\n                prefix: getFunctionNamingPrefix(lNode),\n                lnClass: lNode.getAttribute('lnClass')!,\n                inst: lNode.getAttribute('lnInst')!,\n                lnType: lNode.getAttribute('lnType')!,\n              };\n            }),\n        ],\n      });\n    }\n  });\n\n  return lDeviceDescriptions;\n}\n\n/** Groups all incomming LNode's with non-leaf parent function type elements */\nfunction groupLNodesToFunctions(\n  lNodes: Element[]\n): Record<string, FunctionElementDescription> {\n  const functionElements: Record<string, FunctionElementDescription> = {};\n\n  lNodes.forEach(lNode => {\n    const parentFunction = getNonLeafParent(lNode);\n    if (!parentFunction) return;\n\n    if (functionElements[identity(parentFunction)])\n      functionElements[identity(parentFunction)].lNodes.push(lNode);\n    else {\n      functionElements[identity(parentFunction)] = {\n        uniqueName: getUniqueFunctionName(parentFunction),\n        lNodes: [lNode],\n        lln0: getChildElementsByTagName(parentFunction, 'LNode').find(\n          lNode => lNode.getAttribute('lnClass') === 'LLN0'\n        ),\n      };\n    }\n  });\n\n  return functionElements;\n}\n\nexport default class VirtualTemplateIED extends LitElement {\n  @property({ attribute: false })\n  doc!: XMLDocument;\n  @property({ type: Number })\n  editCount = -1;\n  @state()\n  get isValidManufacturer(): boolean {\n    const manufacturer = this.dialog?.querySelector<WizardTextField>(\n      'wizard-textfield[label=\"manufacturer\"]'\n    )!.value;\n\n    return (manufacturer && manufacturer !== '') || false;\n  }\n  @state()\n  get isValidApName(): boolean {\n    const apName = this.dialog?.querySelector<WizardTextField>(\n      'wizard-textfield[label=\"AccessPoint name\"]'\n    )!.value;\n\n    return (apName && apName !== '') || false;\n  }\n  @state()\n  get someItemsSelected(): boolean {\n    if (!this.selectedLNodeItems) return false;\n    return !!this.selectedLNodeItems.length;\n  }\n  @state()\n  get validPriparyAction(): boolean {\n    return (\n      this.someItemsSelected && this.isValidManufacturer && this.isValidApName\n    );\n  }\n\n  get unreferencedLNodes(): Element[] {\n    return Array.from(\n      this.doc.querySelectorAll('LNode[iedName=\"None\"]')\n    ).filter(lNode => lNode.getAttribute('lnClass') !== 'LLN0');\n  }\n\n  get lLN0s(): Element[] {\n    return Array.from(this.doc.querySelectorAll('LNodeType[lnClass=\"LLN0\"]'));\n  }\n\n  @query('mwc-dialog') dialog!: Dialog;\n  @queryAll('mwc-check-list-item[selected]')\n  selectedLNodeItems?: CheckListItem[];\n\n  async run(): Promise<void> {\n    this.dialog.open = true;\n  }\n\n  private onPrimaryAction(\n    functions: Record<string, FunctionElementDescription>\n  ): void {\n    const selectedLNode = Array.from(\n      this.dialog.querySelectorAll<CheckListItem>(\n        'mwc-check-list-item[selected]:not([disabled])'\n      ) ?? []\n    ).map(selectedItem => find(this.doc, 'LNode', selectedItem.value)!);\n    if (!selectedLNode.length) return;\n\n    const selectedLLN0s = Array.from(\n      this.dialog.querySelectorAll<Select>('mwc-select') ?? []\n    ).map(selectedItem => selectedItem.value);\n\n    const manufacturer = this.dialog.querySelector<WizardTextField>(\n      'wizard-textfield[label=\"manufacturer\"]'\n    )!.value;\n    const desc = this.dialog.querySelector<WizardTextField>(\n      'wizard-textfield[label=\"desc\"]'\n    )!.maybeValue;\n    const apName = this.dialog.querySelector<WizardTextField>(\n      'wizard-textfield[label=\"AccessPoint name\"]'\n    )!.value;\n\n    const ied = getSpecificationIED(this.doc, {\n      manufacturer,\n      desc,\n      apName,\n      lDevices: getLDeviceDescriptions(functions, selectedLNode, selectedLLN0s),\n    });\n\n    // checkValidity: () => true disables name check as is the same here: SPECIFICATION\n    this.dispatchEvent(\n      newActionEvent({\n        new: { parent: this.doc.documentElement, element: ied },\n        checkValidity: () => true,\n      })\n    );\n    this.dialog.close();\n  }\n\n  private onClosed(ae: CustomEvent<{ action: string } | null>): void {\n    if (!(ae.target instanceof Dialog && ae.detail?.action)) return;\n  }\n\n  private renderLLN0s(\n    functionID: string,\n    lLN0Types: Element[],\n    lNode?: Element\n  ): TemplateResult {\n    if (!lNode && !lLN0Types.length) return html``;\n\n    if (lNode)\n      return html`<mwc-select\n        disabled\n        naturalMenuWidth\n        value=\"${functionID + ': ' + lNode.getAttribute('lnType')}\"\n        style=\"width:100%\"\n        label=\"LLN0\"\n        >${html`<mwc-list-item\n          value=\"${functionID + ': ' + lNode.getAttribute('lnType')}\"\n          >${lNode.getAttribute('lnType')}\n        </mwc-list-item>`}</mwc-select\n      >`;\n\n    return html`<mwc-select\n      naturalMenuWidth\n      style=\"width:100%\"\n      label=\"LLN0\"\n      value=\"${functionID + ': ' + lLN0Types[0].getAttribute('id')}\"\n      >${lLN0Types.map(lLN0Type => {\n        return html`<mwc-list-item\n          value=\"${functionID + ': ' + lLN0Type.getAttribute('id')}\"\n          >${lLN0Type.getAttribute('id')}</mwc-list-item\n        >`;\n      })}</mwc-select\n    >`;\n  }\n\n  private renderLNodes(lNodes: Element[], disabled: boolean): TemplateResult[] {\n    return lNodes.map(lNode => {\n      const prefix = getFunctionNamingPrefix(lNode);\n      const lnClass = lNode.getAttribute('lnClass')!;\n      const lnInst = lNode.getAttribute('lnInst')!;\n\n      const label = prefix + ' ' + lnClass + ' ' + lnInst;\n      return html`<mwc-check-list-item\n        ?disabled=${disabled}\n        value=\"${identity(lNode)}\"\n        >${label}</mwc-check-list-item\n      >`;\n    });\n  }\n\n  render(): TemplateResult {\n    if (!this.doc) return html``;\n\n    const existValidLLN0 = this.lLN0s.length !== 0;\n\n    const functionElementDescriptions = groupLNodesToFunctions(\n      this.unreferencedLNodes\n    );\n\n    return html`<mwc-dialog\n      heading=\"Create SPECIFICATION type IED\"\n      @closed=${this.onClosed}\n      ><div>\n        <wizard-textfield\n          label=\"manufacturer\"\n          .maybeValue=${''}\n          required\n          @keypress=${() => this.requestUpdate()}\n        ></wizard-textfield>\n        <wizard-textfield\n          label=\"desc\"\n          .maybeValue=${null}\n          nullable\n        ></wizard-textfield>\n        <wizard-textfield\n          label=\"AccessPoint name\"\n          .maybeValue=${''}\n          required\n          @keypress=${() => this.requestUpdate()}\n        ></wizard-textfield>\n        <filtered-list multi @selected=${() => this.requestUpdate()}\n          >${Object.entries(functionElementDescriptions).flatMap(\n            ([id, functionDescription]) => [\n              html`<mwc-list-item\n                twoline\n                noninteractive\n                value=\"${id}\"\n                style=\"font-weight:500\"\n                ><span>${functionDescription.uniqueName}</span\n                ><span slot=\"secondary\"\n                  >${existValidLLN0 ? id : 'Invalid LD: Missing LLN0'}</span\n                ></mwc-list-item\n              >`,\n              this.renderLLN0s(\n                functionDescription.uniqueName,\n                this.lLN0s,\n                functionDescription.lln0\n              ),\n              ...this.renderLNodes(functionDescription.lNodes, !existValidLLN0),\n              html`<li padded divider role=\"separator\"></li>`,\n            ]\n          )}</filtered-list\n        >\n      </div>\n      <mwc-button\n        slot=\"secondaryAction\"\n        dialogAction=\"close\"\n        label=\"${get('close')}\"\n        style=\"--mdc-theme-primary: var(--mdc-theme-error)\"\n      ></mwc-button>\n      <mwc-button\n        ?disabled=${!this.validPriparyAction}\n        slot=\"primaryAction\"\n        icon=\"save\"\n        label=\"${get('save')}\"\n        trailingIcon\n        @click=${() => this.onPrimaryAction(functionElementDescriptions)}\n      ></mwc-button\n    ></mwc-dialog>`;\n  }\n\n  static styles = css`\n    mwc-dialog {\n      --mdc-dialog-max-width: 92vw;\n    }\n\n    div {\n      display: flex;\n      flex-direction: column;\n    }\n\n    div > * {\n      display: block;\n      margin-top: 16px;\n    }\n  `;\n}\n"]}