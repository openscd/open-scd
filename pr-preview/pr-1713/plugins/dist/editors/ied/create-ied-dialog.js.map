{"version":3,"file":"create-ied-dialog.js","sourceRoot":"","sources":["../../../src/editors/ied/create-ied-dialog.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  css,\n  html,\n  LitElement,\n  property,\n  state,\n  TemplateResult,\n  query,\n  customElement,\n} from 'lit-element';\nimport { get, translate } from 'lit-translate';\n\nimport { Dialog } from '@material/mwc-dialog';\nimport '@material/mwc-button';\nimport '@material/mwc-textfield';\n\n/** A dialog component for creating virtual IEDs */\n@customElement('create-ied-dialog')\nexport class CreateIedDialog extends LitElement {\n  @property()\n  doc!: XMLDocument;\n\n  @property({ type: Function })\n  onConfirm!: (iedName: string) => void;\n\n  @query('#createIedDialog') dialog!: Dialog;\n\n  @state()\n  private newIedName = '';\n\n  get open() {\n    return this.dialog?.open ?? false;\n  }\n\n  private isIedNameValid(name: string): boolean {\n    const trimmedName = name.trim();\n    return (\n      trimmedName.length > 0 &&\n      !trimmedName.includes(' ') &&\n      this.isIedNameUnique(trimmedName)\n    );\n  }\n\n  private getIedNameError(name: string): string {\n    const trimmedName = name.trim();\n    if (trimmedName.length === 0) return '';\n    if (trimmedName.includes(' '))\n      return get('iededitor.createDialog.nameFormatError');\n    if (!this.isIedNameUnique(trimmedName))\n      return get('iededitor.createDialog.nameUniqueError');\n    return '';\n  }\n\n  private isIedNameUnique(name: string): boolean {\n    const existingNames = Array.from(this.doc.querySelectorAll('IED'))\n      .map(ied => ied.getAttribute('name'))\n      .filter(n => n !== null) as string[];\n\n    return !existingNames.includes(name);\n  }\n\n  public show(): void {\n    this.newIedName = '';\n    this.dialog.show();\n  }\n\n  private close(): void {\n    this.dialog.close();\n    this.newIedName = '';\n  }\n\n  private handleCreate(): void {\n    if (this.isIedNameValid(this.newIedName)) {\n      this.onConfirm(this.newIedName);\n      this.close();\n    }\n  }\n\n  render(): TemplateResult {\n    const isNameValid = this.isIedNameValid(this.newIedName);\n    const errorMessage = this.getIedNameError(this.newIedName);\n\n    return html`\n      <mwc-dialog\n        id=\"createIedDialog\"\n        heading=${translate('iededitor.createIed')}\n        @closed=${this.close}\n      >\n        <div class=\"dialog-content\">\n          <mwc-textfield\n            label=${translate('iededitor.createDialog.iedName')}\n            .value=${this.newIedName}\n            .validationMessage=${errorMessage}\n            .validityTransform=${(value: string) => {\n              const error = this.getIedNameError(value);\n              return {\n                valid: error === '',\n                customError: error !== '',\n              };\n            }}\n            autoValidate\n            @input=${(e: Event) => {\n              this.newIedName = (e.target as HTMLInputElement).value;\n            }}\n            required\n            style=\"width: 100%; margin-bottom: 16px;\"\n          ></mwc-textfield>\n        </div>\n        <mwc-button slot=\"secondaryAction\" @click=${this.close}>\n          ${translate('cancel')}\n        </mwc-button>\n        <mwc-button\n          slot=\"primaryAction\"\n          @click=${this.handleCreate}\n          ?disabled=${!isNameValid}\n        >\n          ${translate('create')}\n        </mwc-button>\n      </mwc-dialog>\n    `;\n  }\n\n  static styles = css`\n    .dialog-content {\n      margin-top: 16px;\n    }\n  `;\n}\n"]}