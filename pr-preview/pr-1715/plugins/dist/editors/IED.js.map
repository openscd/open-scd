{"version":3,"file":"IED.js","sourceRoot":"","sources":["../../src/editors/IED.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  css,\n  html,\n  query,\n  property,\n  state,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n} from 'lit-element';\nimport { translate } from 'lit-translate';\nimport { nothing } from 'lit-html';\nimport '@material/mwc-list/mwc-check-list-item';\nimport '@material/mwc-list/mwc-radio-list-item';\nimport '@material/mwc-button';\nimport '@openscd/open-scd/src/oscd-filter-button.js';\n\nimport './ied/ied-container.js';\nimport './ied/element-path.js';\nimport './ied/create-ied-dialog.js';\n\nimport {\n  findLLN0LNodeType,\n  createLLN0LNodeType,\n  createIEDStructure,\n} from './ied/foundation.js';\nimport {\n  compareNames,\n  getDescriptionAttribute,\n  getNameAttribute,\n} from '@openscd/open-scd/src/foundation.js';\nimport { SelectedItemsChangedEvent } from '@openscd/open-scd/src/oscd-filter-button.js';\nimport { Nsdoc } from '@openscd/open-scd/src/foundation/nsdoc.js';\nimport { getIcon } from '@openscd/open-scd/src/icons/icons.js';\nimport { OscdApi, newEditEventV2, InsertV2 } from '@openscd/core';\nimport { CreateIedDialog } from './ied/create-ied-dialog.js';\n\n/** An editor [[`plugin`]] for editing the `IED` section. */\nexport default class IedPlugin extends LitElement {\n  /** The document being edited as provided to plugins by [[`OpenSCD`]]. */\n  @property()\n  doc!: XMLDocument;\n\n  @property({ type: Number })\n  editCount = -1;\n\n  /** All the nsdoc files that are being uploaded via the settings. */\n  @property()\n  nsdoc!: Nsdoc;\n\n  @property()\n  oscdApi: OscdApi | null = null;\n\n  @query('create-ied-dialog') createIedDialog!: CreateIedDialog;\n\n  @state()\n  selectedIEDs: string[] = [];\n\n  @state()\n  selectedLNClasses: string[] = [];\n\n  @state()\n  private get iedList(): Element[] {\n    return this.doc\n      ? Array.from(this.doc.querySelectorAll(':root > IED')).sort((a, b) =>\n          compareNames(a, b)\n        )\n      : [];\n  }\n\n  @state()\n  private get lnClassList(): string[][] {\n    const currentIed = this.selectedIed;\n    const uniqueLNClassList: string[] = [];\n    if (currentIed) {\n      return Array.from(currentIed.querySelectorAll('LN0, LN'))\n        .filter(element => element.hasAttribute('lnClass'))\n        .filter(element => {\n          const lnClass = element.getAttribute('lnClass') ?? '';\n          if (uniqueLNClassList.includes(lnClass)) {\n            return false;\n          }\n          uniqueLNClassList.push(lnClass);\n          return true;\n        })\n        .sort((a, b) => {\n          const aLnClass = a.getAttribute('lnClass') ?? '';\n          const bLnClass = b.getAttribute('lnClass') ?? '';\n\n          return aLnClass.localeCompare(bLnClass);\n        })\n        .map(element => {\n          const lnClass = element.getAttribute('lnClass');\n          const label = this.nsdoc.getDataDescription(element).label;\n          return [lnClass, label];\n        }) as string[][];\n    }\n    return [];\n  }\n\n  @state()\n  private get selectedIed(): Element | undefined {\n    // When there is no IED selected, or the selected IED has no parent (IED has been removed)\n    // select the first IED from the List.\n    if (this.selectedIEDs.length >= 1) {\n      const iedList = this.iedList;\n      return iedList.find(element => {\n        const iedName = getNameAttribute(element);\n        return this.selectedIEDs[0] === iedName;\n      });\n    }\n    return undefined;\n  }\n\n  lNClassListOpenedOnce = false;\n\n  connectedCallback(): void {\n    super.connectedCallback();\n    this.loadPluginState();\n  }\n\n  disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this.storePluginState();\n  }\n\n  private createVirtualIED(iedName: string): void {\n    const inserts: InsertV2[] = [];\n\n    const existingLLN0 = findLLN0LNodeType(this.doc);\n    const lnTypeId = existingLLN0?.getAttribute('id') || 'PlaceholderLLN0';\n\n    const ied = createIEDStructure(this.doc, iedName, lnTypeId);\n\n    const dataTypeTemplates = this.doc.querySelector('DataTypeTemplates');\n    inserts.push({\n      parent: this.doc.querySelector('SCL')!,\n      node: ied,\n      reference: dataTypeTemplates,\n    });\n\n    if (!existingLLN0) {\n      const lnodeTypeInserts = createLLN0LNodeType(this.doc, lnTypeId);\n      inserts.push(...lnodeTypeInserts);\n    }\n\n    this.dispatchEvent(newEditEventV2(inserts));\n\n    this.selectedIEDs = [iedName];\n    this.selectedLNClasses = [];\n    this.requestUpdate('selectedIed');\n  }\n\n  protected updated(_changedProperties: PropertyValues): void {\n    super.updated(_changedProperties);\n\n    // When the document is updated, we reset the selected IED if it no longer exists\n    const isDocumentUpdated =\n      _changedProperties.has('doc') ||\n      _changedProperties.has('editCount') ||\n      _changedProperties.has('nsdoc');\n\n    if (isDocumentUpdated) {\n      // if the IED exists, retain selection\n      const iedExists = this.doc?.querySelector(\n        `IED[name=\"${this.selectedIEDs[0]}\"]`\n      );\n\n      if (iedExists) return;\n\n      this.selectedIEDs = [];\n      this.selectedLNClasses = [];\n      this.lNClassListOpenedOnce = false;\n\n      const iedList = this.iedList;\n      if (iedList.length > 0) {\n        const iedName = getNameAttribute(iedList[0]);\n        if (iedName) {\n          this.selectedIEDs = [iedName];\n        }\n      }\n    }\n  }\n\n  private loadPluginState(): void {\n    const stateApi = this.oscdApi?.pluginState;\n    const selectedIEDs: string[] | null =\n      (stateApi?.getState()?.selectedIEDs as string[]) ?? null;\n\n    if (selectedIEDs) {\n      this.onSelectionChange(selectedIEDs);\n    }\n  }\n\n  private storePluginState(): void {\n    const stateApi = this.oscdApi?.pluginState;\n\n    if (stateApi) {\n      stateApi.setState({ selectedIEDs: this.selectedIEDs });\n    }\n  }\n\n  private calcSelectedLNClasses(): string[] {\n    const somethingSelected = this.selectedLNClasses.length > 0;\n    const lnClasses = this.lnClassList.map(lnClassInfo => lnClassInfo[0]);\n\n    let selectedLNClasses = lnClasses;\n\n    if (somethingSelected) {\n      selectedLNClasses = lnClasses.filter(lnClass =>\n        this.selectedLNClasses.includes(lnClass)\n      );\n    }\n\n    return selectedLNClasses;\n  }\n\n  private onSelectionChange(selectedIeds: string[]): void {\n    const equalArrays = <T>(first: T[], second: T[]): boolean => {\n      return (\n        first.length === second.length &&\n        first.every((val, index) => val === second[index])\n      );\n    };\n\n    const selectionChanged = !equalArrays(this.selectedIEDs, selectedIeds);\n\n    if (!selectionChanged) {\n      return;\n    }\n\n    this.lNClassListOpenedOnce = false;\n    this.selectedIEDs = selectedIeds;\n    this.selectedLNClasses = [];\n    this.requestUpdate('selectedIed');\n  }\n\n  private renderIEDList(): TemplateResult {\n    const iedList = this.iedList;\n    if (iedList.length === 0) {\n      return html`<h1>\n        <span style=\"color: var(--base1)\"\n          >${translate('iededitor.missing')}</span\n        >\n      </h1>`;\n    }\n    return html`<section>\n      <div class=\"header\">\n        <h1>${translate('filters')}:</h1>\n        <oscd-filter-button\n          id=\"iedFilter\"\n          icon=\"developer_board\"\n          .header=${translate('iededitor.iedSelector')}\n          @selected-items-changed=\"${(e: SelectedItemsChangedEvent) =>\n            this.onSelectionChange(e.detail.selectedItems)}\"\n        >\n          ${iedList.map(ied => {\n            const name = getNameAttribute(ied);\n            const descr = getDescriptionAttribute(ied);\n            const type = ied.getAttribute('type');\n            const manufacturer = ied.getAttribute('manufacturer');\n            return html` <mwc-radio-list-item\n              value=\"${name}\"\n              ?twoline=\"${type && manufacturer}\"\n              ?selected=\"${this.selectedIEDs.includes(name ?? '')}\"\n            >\n              ${name} ${descr ? html` (${descr})` : html``}\n              <span slot=\"secondary\">\n                ${type} ${type && manufacturer ? html`&mdash;` : nothing}\n                ${manufacturer}\n              </span>\n            </mwc-radio-list-item>`;\n          })}\n        </oscd-filter-button>\n\n        <oscd-filter-button\n          id=\"lnClassesFilter\"\n          multi=\"true\"\n          .header=\"${translate('iededitor.lnFilter')}\"\n          @selected-items-changed=\"${(e: SelectedItemsChangedEvent) => {\n            this.selectedLNClasses = e.detail.selectedItems;\n            this.requestUpdate('selectedIed');\n          }}\"\n        >\n          <span slot=\"icon\">${getIcon('lNIcon')}</span>\n          ${this.lnClassList.map(lnClassInfo => {\n            const value = lnClassInfo[0];\n            const label = lnClassInfo[1];\n            return html`<mwc-check-list-item\n              value=\"${value}\"\n              ?selected=\"${this.selectedLNClasses.includes(value)}\"\n            >\n              ${label}\n            </mwc-check-list-item>`;\n          })}\n        </oscd-filter-button>\n\n        <element-path class=\"elementPath\"></element-path>\n      </div>\n\n      <ied-container\n        .editCount=${this.editCount}\n        .doc=${this.doc}\n        .element=${this.selectedIed}\n        .selectedLNClasses=${this.calcSelectedLNClasses()}\n        .nsdoc=${this.nsdoc}\n      ></ied-container>\n    </section>`;\n  }\n\n  render(): TemplateResult {\n    return html`<div>\n      <mwc-button\n        class=\"add-ied-button\"\n        icon=\"add\"\n        @click=${() => this.createIedDialog.show()}\n      >\n        ${translate('iededitor.createIed')}\n      </mwc-button>\n      ${this.renderIEDList()}\n      <create-ied-dialog\n        .doc=${this.doc}\n        .onConfirm=${(iedName: string) => this.createVirtualIED(iedName)}\n      ></create-ied-dialog>\n    </div>`;\n  }\n\n  static styles = css`\n    :host {\n      width: 100vw;\n      position: relative;\n    }\n\n    section {\n      padding: 8px 12px 16px;\n    }\n\n    .header {\n      display: flex;\n    }\n\n    h1 {\n      color: var(--mdc-theme-on-surface);\n      font-family: 'Roboto', sans-serif;\n      font-weight: 300;\n      overflow: hidden;\n      white-space: nowrap;\n      text-overflow: ellipsis;\n      margin: 0px;\n      line-height: 48px;\n      padding-left: 0.3em;\n    }\n\n    .elementPath {\n      margin-left: auto;\n      padding-right: 12px;\n    }\n\n    .add-ied-button {\n      display: block;\n      float: right;\n      margin: 8px 12px 0 0;\n    }\n  `;\n}\n"]}